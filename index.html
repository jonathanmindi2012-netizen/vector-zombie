<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Zombie Mobile NEW</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
:root{
  --green:#00ff99;
}
body{
  margin:0;
  background:#050505;
  color:white;
  font-family:Arial;
  overflow:hidden;
}

/* ===== LOBBY ===== */
#lobby{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(#111,#000);
}
#panel{
  width:90%;
  max-width:360px;
  background:#0c111a;
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 40px black;
}
h1{
  text-align:center;
  color:var(--green);
}
label{
  display:block;
  margin-top:15px;
}
input,select{
  width:100%;
}
button{
  width:100%;
  margin-top:20px;
  padding:15px;
  font-size:18px;
  border:none;
  border-radius:15px;
  background:var(--green);
  font-weight:bold;
}

/* ===== GAME ===== */
#game{
  display:none;
}
canvas{
  display:block;
  margin:auto;
  background:#0a0a0a;
}

/* ===== UI ===== */
#ui{
  position:fixed;
  inset:0;
  pointer-events:none;
}
.circle{
  pointer-events:auto;
  position:absolute;
  width:90px;
  height:90px;
  border-radius:50%;
  background:rgba(0,255,153,.15);
  border:2px solid var(--green);
}
#move{bottom:20px;left:20px;}
#fire{bottom:20px;right:20px;}

#skills{
  position:absolute;
  top:10px;
  right:10px;
  display:flex;
  gap:10px;
  pointer-events:auto;
}
.skill{
  padding:10px 14px;
  border-radius:12px;
  background:#000;
  border:2px solid var(--green);
  color:var(--green);
  font-weight:bold;
}
</style>
</head>

<body>

<!-- ===== LOBBY ===== -->
<div id="lobby">
  <div id="panel">
    <h1>ðŸ§Ÿ ZOMBIE MOBILE</h1>

    <label>Sensibilidad
      <input type="range" id="sens" min="0.5" max="3" step="0.1">
    </label>

    <label>Brillo
      <input type="range" id="bright" min="0.5" max="2" step="0.1">
    </label>

    <label>Calidad
      <select id="quality">
        <option value="1">Baja</option>
        <option value="2">Media</option>
        <option value="3">Alta</option>
      </select>
    </label>

    <button onclick="startGame()">JUGAR</button>
  </div>
</div>

<!-- ===== GAME ===== -->
<div id="game">
  <canvas id="canvas" width="360" height="640"></canvas>

  <div id="ui">
    <div id="move" class="circle"></div>
    <div id="fire" class="circle"></div>

    <div id="skills">
      <div class="skill" onclick="ray()">âš¡ 5</div>
      <div class="skill" onclick="boom()">ðŸ’¥ 10</div>
    </div>
  </div>
</div>

<script>
// ===== SETTINGS =====
const settings = JSON.parse(localStorage.getItem("settings")) || {
  sens:1, bright:1, quality:2
};
sens.value=settings.sens;
bright.value=settings.bright;
quality.value=settings.quality;

// ===== VARS =====
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
let player,bullets,zombies,kills;
let moving=false;

// ===== START =====
function startGame(){
  settings.sens=+sens.value;
  settings.bright=+bright.value;
  settings.quality=+quality.value;
  localStorage.setItem("settings",JSON.stringify(settings));

  document.body.style.filter=`brightness(${settings.bright})`;
  lobby.style.display="none";
  game.style.display="block";

  init();
}

function init(){
  player={x:180,y:520,r:16,life:100};
  bullets=[];
  zombies=[];
  kills=0;
  setInterval(spawnZombie,1200);
  requestAnimationFrame(loop);
}

// ===== CONTROLS =====
move.addEventListener("touchstart",()=>moving=true);
move.addEventListener("touchend",()=>moving=false);

fire.addEventListener("touchstart",()=>{
  bullets.push({x:player.x,y:player.y,dy:-7});
});

// ===== ZOMBIES =====
function spawnZombie(){
  zombies.push({
    x:Math.random()*360,
    y:-20,
    r:16,
    speed:0.6+Math.random()
  });
}

// ===== SKILLS =====
function ray(){
  if(kills<5)return;
  zombies=zombies.filter(z=>Math.abs(z.x-player.x)>15);
}
function boom(){
  if(kills<10)return;
  zombies=[];
}

// ===== LOOP =====
function loop(){
  ctx.clearRect(0,0,360,640);

  if(moving) player.x+=settings.sens*2;

  ctx.fillStyle="#00ff99";
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="white";
  bullets.forEach(b=>{
    b.y+=b.dy;
    ctx.fillRect(b.x,b.y,4,8);
  });

  zombies.forEach(z=>{
    z.y+=z.speed;
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(z.x,z.y,z.r,0,Math.PI*2);
    ctx.fill();
  });

  bullets.forEach((b,bi)=>{
    zombies.forEach((z,zi)=>{
      if(Math.hypot(b.x-z.x,b.y-z.y)<z.r){
        bullets.splice(bi,1);
        zombies.splice(zi,1);
        kills++;
      }
    });
  });

  ctx.fillStyle="#0f0";
  ctx.fillText("â¤ï¸ "+player.life,10,20);
  ctx.fillText("â˜ ï¸ "+kills,10,40);

  requestAnimationFrame(loop);
}
</script>
</body>
</html>
